(function(e){function t(t){for(var a,r,o=t[0],c=t[1],l=t[2],f=0,u=[];f<o.length;f++)r=o[f],Object.prototype.hasOwnProperty.call(n,r)&&n[r]&&u.push(n[r][0]),n[r]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);d&&d(t);while(u.length)u.shift()();return i.push.apply(i,l||[]),s()}function s(){for(var e,t=0;t<i.length;t++){for(var s=i[t],a=!0,o=1;o<s.length;o++){var c=s[o];0!==n[c]&&(a=!1)}a&&(i.splice(t--,1),e=r(r.s=s[0]))}return e}var a={},n={app:0},i=[];function r(t){if(a[t])return a[t].exports;var s=a[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=e,r.c=a,r.d=function(e,t,s){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(s,a,function(t){return e[t]}.bind(null,a));return s},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var d=c;i.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"0685":function(e,t,s){},"0688":function(e,t,s){},"07ef":function(e,t,s){e.exports=s.p+"img/lying-face_1f925.9e8779f3.png"},"09c2":function(e,t,s){},"0c54":function(e,t,s){var a={"./angry-face_1f620.png":"3a65","./anxious-face-with-sweat_1f630.png":"6db9","./astonished-face_1f632.png":"1c15","./beaming-face-with-smiling-eyes_1f601.png":"c77b","./confounded-face_1f616.png":"1785","./disguised-face_1f978.png":"b236","./dizzy-face_1f635.png":"94d2","./drooling-face_1f924.png":"7190","./exploding-head_1f92f.png":"d46d","./face-blowing-a-kiss_1f618.png":"238e","./face-savoring-food_1f60b.png":"0d9f","./face-screaming-in-fear_1f631.png":"a2e8","./face-vomiting_1f92e.png":"9e08","./face-with-hand-over-mouth_1f92d.png":"6c3d","./face-with-head-bandage_1f915.png":"2e64","./face-with-medical-mask_1f637.png":"20a2","./face-with-monocle_1f9d0.png":"bafb","./face-with-rolling-eyes_1f644.png":"63ee","./face-with-steam-from-nose_1f624.png":"531c","./face-with-symbols-on-mouth_1f92c.png":"511e","./face-with-tears-of-joy_1f602.png":"7880","./face-with-thermometer_1f912.png":"d2e8","./fearful-face_1f628.png":"b31a","./flushed-face_1f633.png":"a454","./frowning-face_2639-fe0f.png":"4f2b","./grimacing-face_1f62c.png":"a060","./grinning-face-with-smiling-eyes_1f604.png":"1348","./grinning-squinting-face_1f606.png":"fa70","./hot-face_1f975.png":"e6f2","./hugging-face_1f917.png":"9dcc","./kissing-face-with-closed-eyes_1f61a.png":"15ab","./loudly-crying-face_1f62d.png":"30a9","./lying-face_1f925.png":"07ef","./money-mouth-face_1f911.png":"7284","./partying-face_1f973.png":"bec4","./persevering-face_1f623.png":"ef5e","./pleading-face_1f97a.png":"ebd3","./pouting-face_1f621.png":"0f2f","./rolling-on-the-floor-laughing_1f923.png":"5e28","./shushing-face_1f92b.png":"2670","./sleeping-face_1f634.png":"eab6","./sleepy-face_1f62a.png":"5b36","./smiling-face-with-halo_1f607.png":"18ed","./smiling-face-with-heart-eyes_1f60d.png":"fc6c","./smiling-face-with-hearts_1f970.png":"6dbe","./smiling-face-with-smiling-eyes_1f60a.png":"efea","./smiling-face-with-sunglasses_1f60e.png":"b8e1","./smiling-face_263a-fe0f.png":"898e","./star-struck_1f929.png":"2c69","./thinking-face_1f914.png":"81b6","./upside-down-face_1f643.png":"daa5","./yawning-face_1f971.png":"69e2","./zany-face_1f92a.png":"f828","./zipper-mouth-face_1f910.png":"1bdf"};function n(e){var t=i(e);return s(t)}function i(e){if(!s.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}n.keys=function(){return Object.keys(a)},n.resolve=i,e.exports=n,n.id="0c54"},"0d9f":function(e,t,s){e.exports=s.p+"img/face-savoring-food_1f60b.49211633.png"},"0f2f":function(e,t,s){e.exports=s.p+"img/pouting-face_1f621.38dee1ff.png"},"127f":function(e,t,s){},1348:function(e,t,s){e.exports=s.p+"img/grinning-face-with-smiling-eyes_1f604.91100471.png"},"14b7":function(e,t,s){"use strict";s("0688")},"15ab":function(e,t,s){e.exports=s.p+"img/kissing-face-with-closed-eyes_1f61a.fb5d503e.png"},1785:function(e,t,s){e.exports=s.p+"img/confounded-face_1f616.031a0853.png"},1835:function(e,t,s){"use strict";s("0685")},"18ed":function(e,t,s){e.exports=s.p+"img/smiling-face-with-halo_1f607.ccafb14e.png"},"1bdf":function(e,t,s){e.exports=s.p+"img/zipper-mouth-face_1f910.d73776c7.png"},"1c15":function(e,t,s){e.exports=s.p+"img/astonished-face_1f632.1552b306.png"},"1cf6":function(e,t,s){var a={"./angry-face_1f620.png":"3a65","./anxious-face-with-sweat_1f630.png":"6db9","./astonished-face_1f632.png":"1c15","./beaming-face-with-smiling-eyes_1f601.png":"c77b","./confounded-face_1f616.png":"1785","./disguised-face_1f978.png":"b236","./dizzy-face_1f635.png":"94d2","./drooling-face_1f924.png":"7190","./exploding-head_1f92f.png":"d46d","./face-blowing-a-kiss_1f618.png":"238e","./face-savoring-food_1f60b.png":"0d9f","./face-screaming-in-fear_1f631.png":"a2e8","./face-vomiting_1f92e.png":"9e08","./face-with-hand-over-mouth_1f92d.png":"6c3d","./face-with-head-bandage_1f915.png":"2e64","./face-with-medical-mask_1f637.png":"20a2","./face-with-monocle_1f9d0.png":"bafb","./face-with-rolling-eyes_1f644.png":"63ee","./face-with-steam-from-nose_1f624.png":"531c","./face-with-symbols-on-mouth_1f92c.png":"511e","./face-with-tears-of-joy_1f602.png":"7880","./face-with-thermometer_1f912.png":"d2e8","./fearful-face_1f628.png":"b31a","./flushed-face_1f633.png":"a454","./frowning-face_2639-fe0f.png":"4f2b","./grimacing-face_1f62c.png":"a060","./grinning-face-with-smiling-eyes_1f604.png":"1348","./grinning-squinting-face_1f606.png":"fa70","./hot-face_1f975.png":"e6f2","./hugging-face_1f917.png":"9dcc","./kissing-face-with-closed-eyes_1f61a.png":"15ab","./loudly-crying-face_1f62d.png":"30a9","./lying-face_1f925.png":"07ef","./money-mouth-face_1f911.png":"7284","./partying-face_1f973.png":"bec4","./persevering-face_1f623.png":"ef5e","./pleading-face_1f97a.png":"ebd3","./pouting-face_1f621.png":"0f2f","./rolling-on-the-floor-laughing_1f923.png":"5e28","./shushing-face_1f92b.png":"2670","./sleeping-face_1f634.png":"eab6","./sleepy-face_1f62a.png":"5b36","./smiling-face-with-halo_1f607.png":"18ed","./smiling-face-with-heart-eyes_1f60d.png":"fc6c","./smiling-face-with-hearts_1f970.png":"6dbe","./smiling-face-with-smiling-eyes_1f60a.png":"efea","./smiling-face-with-sunglasses_1f60e.png":"b8e1","./smiling-face_263a-fe0f.png":"898e","./star-struck_1f929.png":"2c69","./thinking-face_1f914.png":"81b6","./upside-down-face_1f643.png":"daa5","./yawning-face_1f971.png":"69e2","./zany-face_1f92a.png":"f828","./zipper-mouth-face_1f910.png":"1bdf"};function n(e){var t=i(e);return s(t)}function i(e){if(!s.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}n.keys=function(){return Object.keys(a)},n.resolve=i,e.exports=n,n.id="1cf6"},"1e4b":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("asideMenu"),t("keep-alive",[t(e.activeTabName,{tag:"component"})],1),t("el-drawer",{attrs:{title:"",direction:"ltr",size:"600px","append-to-body":!0,visible:e.userInfoVisible,"before-close":e.handleCloseUserInfo},on:{"update:visible":function(t){e.userInfoVisible=t}}},[t("userInfo",{on:{sendMsg:e.sendMsg,close:e.handleCloseUserInfo}})],1)],1)},n=[],i=s("2f62"),r=s("2ef0"),o=s("d800"),c=function(){var e=this,t=e._self._c;return t("div",{staticClass:"aside-menu"},[t("div",{staticClass:"avatar-con",on:{click:function(t){return e.getUserInfo(e.userId)}}},[t("avatar",{attrs:{size:40,shape:"square",src:e.avatar}})],1),e._l(e.tabList,(function(s,a){return t("i",{key:a,staticClass:"iconfont",class:{["icon-"+s.value]:!0,active:e.activeTabName===s.value},attrs:{title:s.label},on:{click:function(t){return e.setTabName(s.value)}}},[s.dot?t("i",{staticClass:"iconfont icon-dot"}):e._e()])}))],2)},l=[],d={name:"aside-menu",computed:{tabList(){return[{label:"聊天",value:"tab-chat",dot:this.msgTips},{label:"好友",value:"tab-friend",dot:this.friendRequest}]},...Object(i["d"])(["friendRequest","activeTabName","msgTips"])},methods:{...Object(i["b"])(["getUserInfo"]),...Object(i["c"])(["setTabName"])},mounted(){}},f=d,u=(s("7f8f"),s("2877")),p=Object(u["a"])(f,c,l,!1,null,"1364a779",null),g=p.exports,h=function(){var e=this,t=e._self._c;return t("div",{staticClass:"tab-wrapper tab-chat"},[t("record"),t("message")],1)},m=[],b=function(){var e=this,t=e._self._c;return t("div",{staticClass:"record"},[t("search",{attrs:{title:"创建群聊"},on:{action:e.createGroup},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}}),t("list",{attrs:{keyword:e.keyword}}),t("createGroup",{ref:"createGroup"})],1)},_=[],v=function(){var e=this,t=e._self._c;return t("ul",{staticClass:"list"},e._l(e.filterList,(function(s,a){return t("li",{key:a,class:{active:e.activeChat.chatId===s.chatId},on:{click:function(t){return e.changeActiveChatAction(s)}}},[t("div",{staticClass:"avatar-con"},[t("avatar",{attrs:{shape:"square",size:40,src:s.chatAvatar}})],1),t("div",{staticClass:"record-msg"},[t("div",{staticClass:"l"},[t("p",{staticClass:"name"},[e._v(e._s(s.chatName))]),t("p",{staticClass:"content"},["2"===s.chatType?[e._v(" "+e._s(s.fromUsername)+"： ")]:e._e(),e._v(" "+e._s(e._f("msg")(s))+" ")],2)]),t("div",{staticClass:"r"},[t("p",{staticClass:"time"},[e._v(e._s(e._f("formatDate")(s.createTime)))])])]),s.tips?t("i",{staticClass:"iconfont icon-dot"}):e._e()])})),0)},y=[],w=s("c1df"),j=s.n(w),x={name:"list",props:{keyword:{type:String,default:""}},data(){return{}},computed:{filterList(){return this.chatList&&this.chatList.length?this.chatList.filter(e=>-1!==e.chatName.indexOf(this.keyword)):[]},...Object(i["d"])(["activeChat","chatList"])},filters:{formatDate(e){return e?j()(e).format("HH:mm"):""},msg(e){return"3"===e.msgType?"[图片]":"4"===e.msgType?"[文件]":e.msg}},watch:{chatList:{deep:!0,immediate:!0,handler(e){}}},methods:{init(){this.getChatList()},changeActiveChatAction(e){this.changeActiveChat(e)},...Object(i["c"])(["changeActiveChat"]),...Object(i["b"])(["getChatList"])},mounted(){this.init()}},k=x,C=(s("398c"),Object(u["a"])(k,v,y,!1,null,"18833e92",null)),I=C.exports,T=function(){var e=this,t=e._self._c;return t("div",{staticClass:"search"},[t("div",{staticClass:"search-wrapper"},[t("el-input",e._b({attrs:{"prefix-icon":"el-icon-search",placeholder:"搜索",clearable:""},on:{input:e.input}},"el-input",e.$attrs,!1)),t("i",{staticClass:"el-icon-plus",attrs:{title:e.title},on:{click:e.action}})],1)])},O=[],S={name:"search",props:{title:{type:String,default:""}},data(){return{}},methods:{input(e){this.$emit("input",e)},action(){this.$emit("action")}}},L=S,U=(s("d7df"),Object(u["a"])(L,T,O,!1,null,"0a191f58",null)),$=U.exports,E=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:e.title,visible:e.visible,width:"400px","before-close":e.close,"append-to-body":!0},on:{"update:visible":function(t){e.visible=t}}},[t("el-table",{ref:"table",attrs:{data:e.friend,"show-header":!1,"max-height":500},on:{"selection-change":e.selectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"55",selectable:e.selectable}}),t("el-table-column",{attrs:{property:"username",label:"姓名"},scopedSlots:e._u([{key:"default",fn:function(s){return t("div",{staticClass:"user"},[t("avatar",{attrs:{size:40,src:s.row.avatar}}),t("span",[e._v(e._s(s.row.username))])],1)}}])})],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small"},on:{click:e.close}},[e._v("取消")]),t("el-button",{attrs:{size:"small",type:"primary",disabled:!e.disabled},on:{click:e.submit}},[e._v("确定")])],1)],1)},R=[],A=s("310c"),F={name:"create-group",props:{config:{type:Object,default:()=>{}}},data(){return{visible:!1,friend:[],selection:[]}},computed:{title(){const e=this.config&&this.config.title||"创建群聊";return this.selection&&this.selection.length?`${e}(${this.selection.length})`:e},disabled(){if(!this.config||!this.config.group||!this.config.group.members)return this.selection.length;const e=this.config.group.members.map(e=>e.userId);return this.selection.filter(t=>!e.includes(t.userId)).length}},methods:{init(){this.visible=!0,this.getFriend()},getFriend(){A["a"].list().then(e=>{if(!e.data.flag)return this.$message.auto(e.data);this.friend=e.data.list,this.toggleRowSelection()}).catch(e=>{})},toggleRowSelection(){this.$nextTick(()=>{if(!this.config)return;const{group:e}=this.config;if(!e)return;const{members:t}=e,s=t.map(e=>e.userId);this.friend.forEach(e=>{this.$refs.table.toggleRowSelection(e,s.includes(e.userId))})})},selectionChange(e){this.selection=e},selectable(e,t){if(!this.config)return!0;const{group:s}=this.config;if(!s)return!0;const{members:a}=s,n=a.map(e=>e.userId);return!n.includes(e.userId)},close(){this.visible=!1,this.$refs.table.clearSelection()},submit(){if(this.config&&this.config.group)return this.append();const e=this.selection.map(e=>{const{username:t,userId:s}=e;return{username:t,userId:s}}),t={members:e};o["a"].createGroup(t).then(e=>{this.$message.auto(e.data),e.data.flag&&this.close()}).catch(e=>{})},append(){const e=this.config.group.members.map(e=>e.userId),t=this.selection.filter(t=>!e.includes(t.userId)).map(e=>{const{username:t,userId:s}=e;return{username:t,userId:s}}),s={groupId:this.config.group.groupId,members:t};o["a"].groupAppend(s).then(e=>{this.$message.auto(e.data),e.data.flag&&(this.close(),this.$emit("append",e.data.data),this.$socket.emit("messageGroup",{chatId:this.config.group.groupId,chatType:"2",msg:t.map(e=>e.username).join("、")+" 加入群聊",msgType:"2",createTime:(new Date).getTime()}))}).catch(e=>{})}}},M=F,N=(s("4876"),Object(u["a"])(M,E,R,!1,null,"2bdcf07e",null)),D=N.exports,z={name:"record",components:{list:I,search:$,createGroup:D},data(){return{keyword:""}},methods:{createGroup(){this.$refs.createGroup.init()}}},q=z,V=(s("7b12"),Object(u["a"])(q,b,_,!1,null,"211bc643",null)),G=V.exports,P=function(){var e=this,t=e._self._c;return t("div",{staticClass:"message"},[t("headerMenu",{attrs:{name:e.activeChat.chatName,menu:e.menu}}),t("list",{on:{enable:e.setEnable}}),t("entry")],1)},B=[],H=function(){var e=this,t=e._self._c;return t("ul",{ref:"list",staticClass:"list"},e._l(e.msgList,(function(s,a){return t("li",{key:a},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.showDate(s.createTime,a),expression:"showDate(item.createTime, idx)"}],staticClass:"msg-date"},[t("p",[e._v(e._s(e.formatDate(s.createTime)))])]),t("type"+s.msgType,{tag:"components",attrs:{item:s},on:{scrollToView:e.scrollToView}})],1)})),0)},Y=[],J=function(){var e=this,t=e._self._c;return t("wrapper",e._b({},"wrapper",e.$attrs,!1))},K=[],Q=function(){var e=this,t=e._self._c;return t("div",{staticClass:"wrapper",class:{r:e.item.fromUsername===e.username}},[e._t("wrapper",(function(){return[t("div",{staticClass:"msg-con"},[e.item.fromUsername===e.username?t("div",{staticClass:"container"},[t("div",{staticClass:"content"},[e._t("content",(function(){return[t("div",{domProps:{innerHTML:e._s(e.item.msg)}})]}))],2)]):e._e(),t("div",{staticClass:"avatar-con",on:{click:function(t){return e.viewUser(e.item)}}},[t("avatar",{attrs:{shape:"square",size:40,src:e.item.fromUserAvatar}})],1),e.item.fromUsername!==e.username?t("div",{staticClass:"container"},["2"===e.item.chatType?[t("p",{staticClass:"username"},[e._v(e._s(e.item.fromUsername))])]:e._e(),t("div",{staticClass:"content"},[e._t("content",(function(){return[t("div",{domProps:{innerHTML:e._s(e.item.msg)}})]}))],2)],2):e._e()])]}))],2)},W=[],X={name:"wrapper",computed:{item(){return this.$attrs.item||{}}},methods:{viewUser(e){this.getUserInfo(e.fromUserId)},...Object(i["b"])(["getUserInfo"])}},Z=X,ee=(s("14b7"),Object(u["a"])(Z,Q,W,!1,null,"aa6a36ce",null)),te=ee.exports,se={name:"type1",components:{wrapper:te}},ae=se,ne=Object(u["a"])(ae,J,K,!1,null,"2879606b",null),ie=ne.exports,re=function(){var e=this,t=e._self._c;return t("wrapper",e._b({},"wrapper",e.$attrs,!1),[t("div",{staticClass:"tips",attrs:{slot:"wrapper"},slot:"wrapper"},[t("p",[e._v(e._s(e.item.msg))])])])},oe=[],ce={name:"type2",components:{wrapper:te},computed:{item(){return this.$attrs.item||{}}}},le=ce,de=(s("e15c"),Object(u["a"])(le,re,oe,!1,null,"5aa9d652",null)),fe=de.exports,ue=function(){var e=this,t=e._self._c;return t("wrapper",e._b({},"wrapper",e.$attrs,!1),[t("div",{attrs:{slot:"content"},slot:"content"},[t("img",{attrs:{src:e.src},on:{load:e.load}})])])},pe=[],ge={name:"type3",components:{wrapper:te},computed:{item(){return this.$attrs.item||{}},src(){return this.baseURL+this.item.msg}},methods:{load(){this.$emit("scrollToView")}}},he=ge,me=(s("352d"),Object(u["a"])(he,ue,pe,!1,null,"b1e1faee",null)),be=me.exports,_e=function(){var e=this,t=e._self._c;return t("wrapper",e._b({},"wrapper",e.$attrs,!1),[t("div",{staticClass:"file-wrapper",attrs:{slot:"content"},slot:"content"},[t("i",{staticClass:"iconfont el-icon-document"}),t("div",{staticClass:"name"},[t("div",[e._v(e._s(e._f("fileName")(e.src)))]),t("span",{staticClass:"dl",on:{click:e.download}},[e._v("下载")])])])])},ve=[],ye=(s("88a7"),s("271a"),s("5494"),s("df7c")),we=s.n(ye),je={name:"type4",components:{wrapper:te},filters:{fileName(e){return we.a.basename(e)}},computed:{item(){return this.$attrs.item||{}},src(){return this.baseURL+this.item.msg}},methods:{download(){fetch(this.src).then(e=>e.blob()).then(e=>{const t=document.createElement("a");t.setAttribute("href",URL.createObjectURL(e)),t.setAttribute("download",we.a.basename(this.src)),document.body.appendChild(t),t.click(),document.body.removeChild(t)})}}},xe=je,ke=(s("2d39"),Object(u["a"])(xe,_e,ve,!1,null,"a19bbb1e",null)),Ce=ke.exports,Ie={name:"list",components:{type1:ie,type2:fe,type3:be,type4:Ce},data(){return{}},computed:{...Object(i["d"])(["activeChat","msgList"])},watch:{activeChat:{deep:!0,immediate:!0,handler(e){if(!e.chatId)return this.clearMsgList();this.getMsgList()}},msgList:{deep:!0,immediate:!0,handler(e){this.scrollToView()}}},methods:{getMsgList(){if(this.clearMsgList(),this.activeChat.chatId)switch(this.activeChat.chatType){case"1":this.getSingleRecord();break;case"2":this.getGroupRecord();break}},getGroupRecord(){o["a"].getGroupRecord(this.activeChat.chatId).then(e=>{if(!e.data.flag)return this.$message.auto(e.data);const{list:t,enable:s}=e.data;this.updateMsgList(t),this.$emit("enable",s)}).catch(e=>{})},getSingleRecord(){o["a"].getSingleRecord(this.activeChat.chatId).then(e=>{e.data.flag?(this.updateMsgList(e.data.list),this.$emit("enable",!1)):this.$message.auto(e.data)}).catch(e=>{})},scrollToView(){this.$nextTick(()=>{this.msgList&&this.msgList.length&&this.$refs.list&&this.$refs.list.children[this.msgList.length-1].scrollIntoView()})},viewUser(e){this.getUserInfo(e.fromUserId)},formatDate(e){return j()(e).format("YYYY/MM/DD HH:mm:ss")},showDate(e,t){return 0===t||new Date(e).getTime()-new Date(this.msgList[t-1].createTime).getTime()>9e5},...Object(i["c"])(["updateMsgList","clearMsgList"]),...Object(i["b"])(["getUserInfo"])},activated(){this.scrollToView()}},Te=Ie,Oe=(s("4140"),Object(u["a"])(Te,H,Y,!1,null,"b5984506",null)),Se=Oe.exports,Le=function(){var e=this,t=e._self._c;return e.activeChat.chatId?t("div",{staticClass:"entry"},[t("div",{staticClass:"opt"},[t("i",{staticClass:"iconfont icon-emotion",attrs:{title:"表情"},on:{click:function(t){return t.stopPropagation(),e.changeEmojiVisible.apply(null,arguments)}}}),t("i",{staticClass:"iconfont icon-folder",attrs:{title:"文件"},on:{click:e.upload}}),t("i",{staticClass:"iconfont icon-cut",attrs:{title:"截图"}}),t("i",{staticClass:"iconfont icon-record",attrs:{title:"记录"}})]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.msg,expression:"msg"}],domProps:{value:e.msg},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.keydown.apply(null,arguments)},input:function(t){t.target.composing||(e.msg=t.target.value)}}}),t("div",{staticClass:"sendBtn"},[t("el-button",{on:{click:e.send}},[e._v("发送")])],1),t("uploadFile",{ref:"uploadFile",on:{preview:e.preview,success:e.uploadFileSuccess}}),t("emoji",{ref:"emoji",attrs:{visible:e.emojiVisible},on:{"update:visible":function(t){e.emojiVisible=t}}})],1):e._e()},Ue=[],$e=function(){var e=this,t=e._self._c;return t("div",{staticClass:"upload-file"},[t("input",{ref:"file",attrs:{type:"file",hidden:""},on:{change:e.uploadFile}})])},Ee=[],Re=s("365c"),Ae={name:"upload-file",methods:{init(){this.$refs.file.value="",this.$refs.file.click()},uploadFile(){const e=this.$refs.file.files[0];if(!e)return;this.$emit("preview",this.getFileSrc(e));const t=new FormData;t.append("files",e,e.name);const s=this.$loading({lock:!0,text:"文件上传中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});Re["a"].uploadFile(t).then(t=>{s.close(),this.$message.auto(t.data),this.$emit("success",{url:t.data.url,type:e.type.startsWith("image/")?"3":"4"})}).catch(e=>{s.close()})},getFileSrc(e){if(!e)return null;const t=window.URL||window.webkitURL;return t.createObjectURL(e)}}},Fe=Ae,Me=(s("95bf"),Object(u["a"])(Fe,$e,Ee,!1,null,"61cf5d29",null)),Ne=Me.exports,De=function(){var e=this,t=e._self._c;return e.visible?t("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.outside,expression:"outside"}],staticClass:"emoji"},[t("ul",e._l(e.list,(function(e,s){return t("li",{key:s},[t("img",{attrs:{src:e.value}})])})),0)]):e._e()},ze=[];const qe=s("1cf6"),Ve=qe.keys().map(e=>({label:e.substring(e.indexOf("/")+1,e.indexOf("_")),value:s("0c54")("./"+e.substring(e.indexOf("/")+1))}));var Ge=Ve,Pe={name:"emoji",props:{visible:Boolean},data(){return{list:Ge}},methods:{outside(){this.$emit("update:visible",!1)}}},Be=Pe,He=(s("5f35"),Object(u["a"])(Be,De,ze,!1,null,"513c1d58",null)),Ye=He.exports,Je={name:"entry",components:{uploadFile:Ne,emoji:Ye},data(){return{msg:"",emojiVisible:!1}},computed:{...Object(i["d"])(["activeChat"])},sockets:{connect(e){console.log("connect",e)},reconnect(e){console.log("reconnect",e)},disconnect(e){console.log("disconnect",e)},res:function(e){},message:function(e){this.updateMsgList([e])},messageResponse:function(e){this.updateMsgList([e]),this.setMsgTips(!0)},friendRelated:function(e){switch(e.type){case"request":this.changeFriendRequest(!0);break;case"agree":this.getFriendList();break;case"remove":this.getFriendList();break}},tips:function(e){e&&e.type&&e.text&&this.$message[e.type](e.text)},group:function(e){switch(this.getChatList(),e.type){case"joinRoom":e.groupId&&this.$socket.emit("joinRoom",e.groupId);break;case"leaveRoom":e.groupId&&this.$socket.emit("leaveRoom",e.groupId);break}}},methods:{init(){},keydown(e){return this.send(),e.preventDefault(),!1},send(e=null,t=null){if(e=e||this.msg,t=t||"1",!e)return this.$message.warning("消息不能为空");const{chatId:s,chatType:a,withUsername:n,withUserId:i}=this.activeChat,r={chatId:s,chatType:a,msg:e,msgType:t,createTime:(new Date).getTime(),withUsername:n,withUserId:i},o="1"===a?"messageSingle":"messageGroup";this.$socket.emit(o,r),this.msg=""},upload(){this.$refs.uploadFile.init()},preview(e){},uploadFileSuccess({url:e,type:t}){this.send(e,t)},changeEmojiVisible(){this.emojiVisible=!this.emojiVisible},...Object(i["c"])(["updateMsgList","changeFriendRequest","setMsgTips"]),...Object(i["b"])(["getFriendList","getChatList"])},mounted(){this.init()}},Ke=Je,Qe=(s("cd30"),Object(u["a"])(Ke,Le,Ue,!1,null,"b63fe9da",null)),We=Qe.exports,Xe=function(){var e=this,t=e._self._c;return t("div",{staticClass:"header-menu"},[t("p",[e._v(e._s(e.name||""))]),e.menu?[e.menu.enable?t("i",{staticClass:"el-icon-more",on:{click:e.showDrawer}}):t("el-dropdown",{attrs:{trigger:"click"}},[t("i",{staticClass:"el-icon-more"}),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{nativeOn:{click:function(t){return e.removeChat.apply(null,arguments)}}},[e._v("删除会话")])],1)],1)]:e._e(),t("groupInfo",{ref:"groupInfo"})],2)},Ze=[],et=function(){var e=this,t=e._self._c;return t("el-drawer",{attrs:{title:"",direction:"rtl",size:"600px","append-to-body":!0,visible:e.visible,"before-close":e.handleClose},on:{"update:visible":function(t){e.visible=t}}},[e.group&&e.group.groupId?t("div",{staticClass:"group-info-wrapper"},[t("el-form",{attrs:{"label-width":"80px"}},[t("el-form-item",{attrs:{label:"群名称"}},[t("span",[e._v(e._s(e.group.groupName))]),e.isMaster?t("i",{staticClass:"iconfont icon-edit",on:{click:function(t){return e.edit("群名称","groupName",e.group.groupName)}}}):e._e()]),t("el-form-item",{attrs:{label:"群公告"}},[t("span",[e._v(e._s(e.group.announcement||"-"))]),e.isMaster?t("i",{staticClass:"iconfont icon-edit",on:{click:function(t){return e.edit("群公告","announcement",e.group.announcement)}}}):e._e()]),t("el-form-item",{attrs:{label:"群成员"}},[t("ul",{staticClass:"members"},[e._l(e.group.members,(function(s,a){return t("li",{key:a,on:{click:function(t){return e.getUserInfo(s.userId)}}},[e.group.master===s.userId?t("i",{staticClass:"iconfont icon-crown"}):e._e(),e.group.master!==s.userId&&e.isMaster?t("i",{staticClass:"iconfont icon-remove",on:{click:function(t){return t.stopPropagation(),e.remove(s)}}}):e._e(),t("avatar",{attrs:{size:60,src:s.avatar}}),t("p",[e._v(e._s(s.username))])],1)})),t("li",[t("div",{staticClass:"member-add",attrs:{title:"添加成员"},on:{click:e.append}},[t("i",{staticClass:"iconfont icon-add"})])])],2)]),t("el-form-item",[e.group.master===e.userId?t("el-button",{attrs:{type:"primary"},on:{click:e.disband}},[e._v("解散群聊")]):t("el-button",{attrs:{type:"primary"},on:{click:e.quit}},[e._v("退出群聊")])],1)],1)],1):e._e(),t("createGroup",{ref:"createGroup",attrs:{config:e.createGroupConfig},on:{append:e.appendSuccess}})],1)},tt=[],st=s("4328"),at=s.n(st),nt={name:"group-info",components:{createGroup:D},data(){return{visible:!1,group:{}}},computed:{isMaster(){return this.group.master===this.userId},createGroupConfig(){return{title:"添加成员",group:this.group}}},methods:{init(e){this.visible=!0,this.getInfo(e)},getInfo(e){o["a"].groupInfo(e).then(e=>{if(!e.data.flag)return this.$message.auto(e.data);this.group=e.data.data}).catch(e=>{})},edit(e,t,s){this.$prompt("",e,{confirmButtonText:"确定",cancelButtonText:"取消",inputPlaceholder:"请输入",inputValue:s||""}).then(({value:e})=>{this.submitEdit(t,e)}).catch(e=>{})},submitEdit(e,t){e?o["a"].groupUpdate(at.a.stringify({groupId:this.group.groupId,[e]:t})).then(e=>{this.$message.auto(e.data),e.data.flag&&(this.group=e.data.data,this.getChatList())}).catch(e=>{}):this.$message.error("数据有误")},remove(e){this.$confirm(`您确认要把&nbsp;<span style="color:red;">${e.username}</span>&nbsp;移出群聊吗？`,"提示",{dangerouslyUseHTMLString:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$socket.emit("messageGroup",{chatId:this.group.groupId,chatType:"2",msg:e.username+" 被移出群聊",msgType:"2",createTime:(new Date).getTime()}),o["a"].groupRemove({groupId:this.group.groupId,memberId:e.userId}).then(e=>{this.$message.auto(e.data),e.data.flag&&(this.group=e.data.data)}).catch(e=>{})}).catch(e=>{})},append(){this.$refs.createGroup.init()},appendSuccess(e){this.group=e},quit(){this.$confirm("您确定要退出群聊吗？","提示",{dangerouslyUseHTMLString:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{o["a"].groupQuit({groupId:this.group.groupId}).then(e=>{this.$message.auto(e.data),e.data.flag&&(this.getChatList(),this.handleClose())}).catch(e=>{})}).catch(e=>{})},disband(){this.$confirm("您确定要解散群聊吗？","提示",{dangerouslyUseHTMLString:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$socket.emit("messageGroup",{chatId:this.group.groupId,chatType:"2",msg:"群聊已解散",msgType:"2",createTime:(new Date).getTime()}),o["a"].groupDisband(this.group.groupId).then(e=>{this.$message.auto(e.data),e.data.flag&&(this.getChatList(),this.handleClose())}).catch(e=>{})}).catch(e=>{})},handleClose(){this.visible=!1,this.group={}},...Object(i["b"])(["getUserInfo","getChatList"])}},it=nt,rt=(s("b6ba"),Object(u["a"])(it,et,tt,!1,null,"240948a4",null)),ot=rt.exports,ct={name:"header-menu",components:{groupInfo:ot},props:{name:{type:String,default:""},menu:{type:Object,default:null}},data(){return{visible:!1}},computed:{...Object(i["d"])(["activeChat"])},methods:{showDrawer(){switch(this.visible=!0,this.menu.type){case"chat":this.getInfo(this.menu.data);break}},getInfo(e){switch(e.chatType){case"1":break;case"2":this.$refs.groupInfo.init(e.chatId);break}},handleClose(){this.visible=!1},removeChat(){o["a"].chatRemove(this.activeChat.chatId).then(e=>{this.$message.auto(e.data),e.data.flag&&this.getChatList()}).catch(e=>{})},...Object(i["b"])(["getChatList"])}},lt=ct,dt=(s("8910"),Object(u["a"])(lt,Xe,Ze,!1,null,"2d677fc1",null)),ft=dt.exports,ut={name:"message",components:{list:Se,entry:We,headerMenu:ft},data(){return{enable:!1}},computed:{menu(){return this.activeChat.chatId?{type:"chat",enable:this.enable,data:this.activeChat}:null},...Object(i["d"])(["activeChat"])},methods:{setEnable(e){this.enable=e}}},pt=ut,gt=(s("d634"),Object(u["a"])(pt,P,B,!1,null,"7e5b403e",null)),ht=gt.exports,mt={name:"tab-chat",components:{record:G,message:ht}},bt=mt,_t=(s("dde3"),Object(u["a"])(bt,h,m,!1,null,"4a05496c",null)),vt=_t.exports,yt=function(){var e=this,t=e._self._c;return t("div",{staticClass:"tab-wrapper tab-friend"},[t("friend"),t("friendInfo")],1)},wt=[],jt=function(){var e=this,t=e._self._c;return t("div",{staticClass:"friend"},[t("search",{attrs:{title:"添加好友"},on:{action:e.showAddFriend},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}}),t("list",{attrs:{keyword:e.keyword},on:{showRequest:e.showAddReq}}),t("el-dialog",{attrs:{title:"添加好友",visible:e.visibleAdd,width:"450px","before-close":e.handleCloseAdd},on:{"update:visible":function(t){e.visibleAdd=t}}},[t("div",{staticClass:"search-con"},[t("el-input",{attrs:{placeholder:"请输入用户名","prefix-icon":"el-icon-search"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchUser.apply(null,arguments)}},model:{value:e.searchKeyword,callback:function(t){e.searchKeyword=t},expression:"searchKeyword"}}),t("el-button",{attrs:{type:"primary",loading:e.addBtnLoading},on:{click:e.searchUser}},[e._v("搜索")])],1),e.searchFriendTableData.length?t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.searchFriendTableData,border:""}},[t("el-table-column",{attrs:{prop:"username",label:"用户名"}}),t("el-table-column",{attrs:{label:"操作",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(s){return s.row.username!==e.username?[["0","4"].includes(s.row.friendStatus)?[t("el-button",{attrs:{type:"text",icon:"el-icon-plus"},on:{click:function(t){return e.addFriend(s.row)}}},[e._v("添加")])]:t("span",[e._v(e._s(s.row.friendStatusText))])]:void 0}}],null,!0)})],1):e._e()],1),t("el-dialog",{attrs:{title:"好友申请",visible:e.visibleAddReq,width:"30%","before-close":e.handleCloseAddReq},on:{"update:visible":function(t){e.visibleAddReq=t}}},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.addReqTableData,border:""}},[t("el-table-column",{attrs:{prop:"friendUsername",label:"用户名"}}),t("el-table-column",{attrs:{prop:"msg",label:"留言"}}),t("el-table-column",{attrs:{label:"操作",width:"160",align:"center"},scopedSlots:e._u([{key:"default",fn:function(s){return["3"===s.row.friendStatus?[t("el-button",{attrs:{type:"text",icon:"el-icon-close"},on:{click:function(t){return e.refuse(s.row)}}},[e._v("拒绝")]),t("el-button",{attrs:{type:"text",icon:"el-icon-check"},on:{click:function(t){return e.agree(s.row)}}},[e._v("同意")])]:t("span",[e._v(e._s(s.row.friendStatusText))])]}}])})],1)],1)],1)},xt=[],kt=function(){var e=this,t=e._self._c;return t("div",{staticClass:"list"},[t("div",{staticClass:"friend-request"},[t("el-button",{attrs:{size:"small"},on:{click:e.showRequest}},[e._v("好友申请")]),e.friendRequest?t("i",{staticClass:"iconfont icon-dot"}):e._e()],1),t("ul",e._l(e.filterList,(function(s,a){return t("li",{key:a,class:{active:!1},on:{click:function(t){return e.showUser(s)}}},[t("div",{staticClass:"avatar-con",attrs:{"data-i":s.avatar}},[t("avatar",{attrs:{shape:"square",size:40,src:s.avatar}})],1),t("p",{staticClass:"name"},[e._v(e._s(s.username))])])})),0)])},Ct=[],It={name:"friend-list",props:{keyword:{type:String,default:""}},data(){return{}},computed:{filterList(){return this.friendList&&this.friendList.length?this.friendList.filter(e=>-1!==e.username.indexOf(this.keyword)):[]},...Object(i["d"])(["friendRequest","friendList"])},methods:{init(){this.getFriendList()},showUser(e){this.getUserInfo(e.userId)},showRequest(){this.$emit("showRequest")},...Object(i["b"])(["getUserInfo","getFriendList"])},mounted(){},activated(){this.init()}},Tt=It,Ot=(s("f8cb"),Object(u["a"])(Tt,kt,Ct,!1,null,"033ced56",null)),St=Ot.exports,Lt=s("c24f"),Ut={name:"friend",components:{list:St,search:$},data(){return{keyword:"",addBtnLoading:!1,visibleAdd:!1,searchKeyword:"",searchFriendTableData:[],visibleAddReq:!1,addReqTableData:[]}},methods:{showAddReq(){this.getFriendRequestList(),this.visibleAddReq=!0},getFriendRequestList(){A["a"].requestList().then(e=>{this.addReqTableData=e.data.list}).catch(e=>{})},showAddFriend(){this.visibleAdd=!0},handleCloseAdd(){this.visibleAdd=!1,this.searchKeyword="",this.searchFriendTableData=[]},searchUser(){this.addBtnLoading=!0,Lt["a"].search({keyword:this.searchKeyword}).then(e=>{this.addBtnLoading=!1,e.data.flag?this.searchFriendTableData=e.data.list:this.$message.auto(e.data)}).catch(()=>{this.addBtnLoading=!1})},addFriend(e){this.$prompt("","留言",{confirmButtonText:"确定",cancelButtonText:"取消",inputPlaceholder:"请输入留言",inputValue:"我是"+this.username}).then(({value:t})=>{if(!t)return void this.$message.error("留言不能为空");const s={friendUserId:e.userId,msg:t};A["a"].add(s).then(t=>{this.$message.auto(t.data),t.data.flag&&(e.friendStatus=t.data.friendStatus,e.friendStatusText=t.data.friendStatusText)}).catch(e=>{console.log(e)})}).catch(()=>{})},handleCloseAddReq(){this.visibleAddReq=!1},refuse(e){A["a"].refuse({friendUserId:e.friendUserId}).then(t=>{this.$message.auto(t.data),t.data.flag&&(e.friendStatus=t.data.friendStatus,e.friendStatusText=t.data.friendStatusText)}).catch(e=>{})},agree(e){A["a"].agree({friendUserId:e.friendUserId}).then(t=>{this.$message.auto(t.data),t.data.flag&&(e.friendStatus=t.data.friendStatus,e.friendStatusText=t.data.friendStatusText,this.getFriendList())}).catch(e=>{})},...Object(i["c"])(["changeFriendRequest"]),...Object(i["b"])(["getUserInfo","getFriendList"])},watch:{visibleAddReq(e,t){e&&this.changeFriendRequest(!1)}}},$t=Ut,Et=(s("c6b7"),Object(u["a"])($t,jt,xt,!1,null,"7d63263e",null)),Rt=Et.exports,At=function(){var e=this,t=e._self._c;return t("div",{staticClass:"friend-info"},[t("headerMenu")],1)},Ft=[],Mt={name:"friend-info",components:{headerMenu:ft}},Nt=Mt,Dt=(s("5cc8"),Object(u["a"])(Nt,At,Ft,!1,null,"2710420f",null)),zt=Dt.exports,qt={name:"tab-friend",components:{friend:Rt,friendInfo:zt}},Vt=qt,Gt=(s("d0c2"),Object(u["a"])(Vt,yt,wt,!1,null,"193af0a7",null)),Pt=Gt.exports,Bt=function(){var e=this,t=e._self._c;return e.userInfo.username?t("div",{staticClass:"user-info"},[t("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px"}},[t("el-form-item",{staticClass:"el-form-item-avatar",attrs:{label:""}},[t("avatar",{attrs:{size:100,upload:e.isSelf&&e.uploadCB,src:e.form.avatar}}),e.isSelf?[t("i",{staticClass:"iconfont icon-signout",attrs:{title:"退出"},on:{click:e.signOutConfirm}})]:[t("el-popconfirm",{attrs:{"confirm-button-text":"是的","cancel-button-text":"再想想",title:"确认解除好友关系吗？"},on:{onConfirm:e.removeFriend}},["1"===e.form.friendStatus?t("i",{staticClass:"iconfont icon-friend",attrs:{slot:"reference",title:"好友"},slot:"reference"}):e._e()]),"1"===e.form.friendStatus?t("i",{staticClass:"iconfont icon-tab-chat",attrs:{title:"发消息"},on:{click:e.sendMsg}}):e._e(),["0","2","3","4"].includes(e.form.friendStatus)?t("i",{staticClass:"iconfont icon-add-friend",class:{disabled:["2","3"].includes(e.form.friendStatus)},attrs:{title:e._f("addFriendText")(e.form.friendStatus)},on:{click:e.addFriend}}):e._e()]],2),t("el-divider",[t("i",{staticClass:"el-icon-monitor"})]),t("el-form-item",{attrs:{label:"用户名"}},[t("div",{staticClass:"el-form-item-content"},[t("span",[e._v(e._s(e.form.username))]),t("i",e._b({staticClass:"iconfont",on:{click:e.editSex}},"i",e.sexAttrs,!1))])]),t("el-form-item",{attrs:{label:"昵称"}},[t("div",{staticClass:"el-form-item-content"},[t("span",[e._v(e._s(e.form.nickname||"-"))]),e.isSelf?t("i",{staticClass:"iconfont icon-edit",on:{click:function(t){return e.edit("昵称","nickname")}}}):e._e()])]),t("el-form-item",{attrs:{label:"爱好"}},[t("div",{staticClass:"el-form-item-content"},[t("span",[e._v(e._s(e.form.hobby||"-"))]),e.isSelf?t("i",{staticClass:"iconfont icon-edit",on:{click:function(t){return e.edit("爱好","hobby")}}}):e._e()])]),t("el-form-item",{attrs:{label:"个性签名"}},[t("div",{staticClass:"el-form-item-content"},[t("span",[e._v(e._s(e.form.signature||"-"))]),e.isSelf?t("i",{staticClass:"iconfont icon-edit",on:{click:function(t){return e.edit("个性签名","signature")}}}):e._e()])]),t("el-form-item",{attrs:{label:"加入时间"}},[t("div",{staticClass:"el-form-item-content"},[t("span",[e._v(e._s(e._f("formatDate")(e.form.createDate)))])])])],1),t("confirm",{attrs:{title:"性别",visible:e.dialogVisible},on:{close:function(t){e.dialogVisible=!1},submit:e.submitSex}},[t("el-radio-group",{model:{value:e.sex,callback:function(t){e.sex=t},expression:"sex"}},[t("el-radio",{attrs:{label:"1"}},[t("i",{staticClass:"iconfont icon-male"}),e._v("男")]),t("el-radio",{attrs:{label:"2"}},[t("i",{staticClass:"iconfont icon-female"}),e._v("女")]),t("el-radio",{attrs:{label:"0"}},[t("i",{staticClass:"iconfont icon-sex"}),e._v("保密")])],1)],1),t("confirm",{attrs:{visible:e.signOutVisible},on:{close:e.closeConfirmSignOut}},[t("div",[t("p",{staticStyle:{"font-size":"16px"}},[e._v("您确定要退出吗？")])]),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small"},on:{click:e.closeConfirmSignOut}},[e._v("再想想")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.signOut}},[e._v("退出")])],1)])],1):e._e()},Ht=[],Yt=(s("14d9"),function(){var e=this,t=e._self._c;return t("el-dialog",e._g(e._b({attrs:{"before-close":e.handleClose,title:e.title,visible:e.visible,"append-to-body":!0,width:e.dialogConfirm},on:{"update:visible":function(t){e.visible=t}}},"el-dialog",e.$attrs,!1),e.$listeners),[e._t("default"),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e._t("footer",(function(){return[t("el-button",{attrs:{size:"small"},on:{click:e.close}},[e._v("取消")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.submit}},[e._v("确定")])]}))],2)],2)}),Jt=[];const Kt="420px";var Qt={name:"confirm",props:{title:{type:String,default:"提示"},visible:{type:Boolean,default:!1}},data(){return{dialogConfirm:Kt}},methods:{handleClose(){this.$emit("before-close"),this.close()},close(){this.$emit("close")},submit(){this.$emit("submit")}},mounted(){}},Wt=Qt,Xt=Object(u["a"])(Wt,Yt,Jt,!1,null,"845becd8",null),Zt=Xt.exports,es={name:"user-info",components:{confirm:Zt},data(){return{dialogVisible:!1,sex:"0",signOutVisible:!1}},computed:{isSelf(){return this.username===this.userInfo.username},sexAttrs(){const e=new Map;e.set("0",{icon:"sex",text:"保密"}),e.set("1",{icon:"male",text:"男"}),e.set("2",{icon:"female",text:"女"});const t=this.userInfo.sex||"0";return{class:{editable:this.isSelf,["icon-"+e.get(t).icon]:!0},title:e.get(t).text}},form:{get(){return Object(r["cloneDeep"])(this.userInfo)},set(){}},...Object(i["d"])(["userInfoVisible","userInfo"])},filters:{addFriendText(e){const t=new Map;return t.set("0","添加好友"),t.set("1","已添加"),t.set("2","待对方确认"),t.set("3","待您确认"),t.set("4","添加好友"),t.get(e)}},methods:{init(){},addFriend(){if(!["0","4"].includes(this.form.friendStatus))return;const e=this.form;this.$prompt("","留言",{confirmButtonText:"确定",cancelButtonText:"取消",inputPlaceholder:"请输入留言",inputValue:"我是"+this.username}).then(({value:t})=>{if(!t)return void this.$message.error("留言不能为空");const s={friendUserId:e.userId,msg:t};A["a"].add(s).then(t=>{if(this.$message.auto(t.data),!t.data.flag)return;const{friendStatus:s,friendStatusText:a}=t.data;this.changeUserInfo({...e,friendStatus:s,friendStatusText:a})}).catch(e=>{console.log(e)})}).catch(()=>{})},uploadCB(e){this.submitEdit("avatar",e)},edit(e,t){this.$prompt("",e,{confirmButtonText:"确定",cancelButtonText:"取消",inputPlaceholder:"请输入"}).then(({value:e})=>{this.submitEdit(t,e)}).catch(()=>{})},editSex(){this.isSelf&&(this.sex=this.form.sex,this.dialogVisible=!0)},submitSex(){this.dialogVisible=!1,this.submitEdit("sex",this.sex)},submitEdit(e,t){e?Lt["a"].update(at.a.stringify({[e]:t})).then(e=>{this.$message.auto(e.data),e.data.flag&&(this.changeUserInfo(e.data.data),this.setPersonal(e.data.data))}).catch(e=>{console.log(e)}):this.$message.error("数据有误")},sendMsg(){this.$emit("sendMsg")},removeFriend(){A["a"].remove(this.userInfo.userId).then(e=>{this.$message.auto(e.data),e.data.flag&&(this.$emit("close"),this.getFriendList())}).catch(e=>{})},signOut(){Lt["a"].signOut().then(e=>{this.$router.push("/login")}).catch(e=>{})},signOutConfirm(){this.signOutVisible=!0},closeConfirmSignOut(){this.signOutVisible=!1},...Object(i["c"])(["changeUserInfo","setPersonal"]),...Object(i["b"])(["getFriendList"])},mounted(){this.init()}},ts=es,ss=(s("1835"),Object(u["a"])(ts,Bt,Ht,!1,null,"3be62889",null)),as=ss.exports,ns={name:"index",components:{asideMenu:g,tabChat:vt,tabFriend:Pt,userInfo:as},data(){return{}},computed:{...Object(i["d"])(["userInfoVisible","userInfo","activeTabName"])},methods:{init(){},handleCloseUserInfo(e){this.changeUserInfoVisible(!1)},sendMsg(){const e=Object(r["pick"])(this.userInfo,["username","userId"]);o["a"].send(e).then(e=>{this.setTabName("tab-chat"),this.changeUserInfoVisible(!1),this.addChatList(e.data.data)}).catch(()=>{})},...Object(i["c"])(["changeUserInfoVisible","addChatList","setTabName"])},mounted(){this.init()}},is=ns,rs=(s("9d70"),Object(u["a"])(is,a,n,!1,null,"dffb39b2",null));t["default"]=rs.exports},"1f16":function(e,t,s){},"20a2":function(e,t,s){e.exports=s.p+"img/face-with-medical-mask_1f637.6e6140f7.png"},"238e":function(e,t,s){e.exports=s.p+"img/face-blowing-a-kiss_1f618.5367e339.png"},2670:function(e,t,s){e.exports=s.p+"img/shushing-face_1f92b.aada94e5.png"},"2c69":function(e,t,s){e.exports=s.p+"img/star-struck_1f929.847dace7.png"},"2d39":function(e,t,s){"use strict";s("7b19")},"2e64":function(e,t,s){e.exports=s.p+"img/face-with-head-bandage_1f915.efc9d982.png"},"2f17":function(e,t,s){},"30a9":function(e,t,s){e.exports=s.p+"img/loudly-crying-face_1f62d.e7a0d3b1.png"},"310c":function(e,t,s){"use strict";var a=s("a27e");t["a"]={list(){return a["a"].get("/friend/list")},requestList(){return a["a"].get("/friend/requestList")},add(e){return a["a"].post("/friend/add",{toUserId:"",toUsername:"",msg:"",...e})},agree(e){return a["a"].post("/friend/agree",{toUserId:"",toUsername:"",...e})},refuse(e){return a["a"].post("/friend/refuse",{toUserId:"",toUsername:"",...e})},remove(e){return a["a"].delete("/friend/remove/"+e)}}},"34b2":function(e,t,s){"use strict";s("9815")},"352d":function(e,t,s){"use strict";s("1f16")},"365c":function(e,t,s){"use strict";var a=s("a27e");t["a"]={checkOnline(){return a["a"].get("/checkOnline")},uploadImg(e){return a["a"].post("/uploadImg",e)},uploadFile(e){return a["a"].post("/uploadFile",e)}}},3732:function(e,t,s){},"398c":function(e,t,s){"use strict";s("09c2")},"3a65":function(e,t,s){e.exports=s.p+"img/angry-face_1f620.21a512f1.png"},4140:function(e,t,s){"use strict";s("746d")},4678:function(e,t,s){var a={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-ps":"4c98","./ar-ps.js":"4c98","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn-bd":"9686","./bn-bd.js":"9686","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-mx":"b5b7","./es-mx.js":"b5b7","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku-kmr":"7558","./ku-kmr.js":"7558","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tk":"5aff","./tk.js":"5aff","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function n(e){var t=i(e);return s(t)}function i(e){if(!s.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}n.keys=function(){return Object.keys(a)},n.resolve=i,e.exports=n,n.id="4678"},"483d":function(e,t,s){},4876:function(e,t,s){"use strict";s("abea")},"4ccb":function(e,t,s){},"4d48":function(e,t,s){},"4f2b":function(e,t,s){e.exports=s.p+"img/frowning-face_2639-fe0f.22640c85.png"},"511e":function(e,t,s){e.exports=s.p+"img/face-with-symbols-on-mouth_1f92c.1a6202b4.png"},"531c":function(e,t,s){e.exports=s.p+"img/face-with-steam-from-nose_1f624.fd40d4d4.png"},5441:function(e,t,s){},"56d7":function(e,t,s){"use strict";s.r(t);var a=s("2b0e"),n=function(){var e=this,t=e._self._c;return t("div",{style:e.style,attrs:{id:"app"}},[t("router-view")],1)},i=[],r=s("2f62"),o=s("5d2d"),c={data(){return{style:{}}},sockets:{},methods:{init(){this.setTheme(o["a"].local.get("theme")),this.setPersonal(o["a"].local.get("data_user"))},...Object(r["c"])(["setTheme","setPersonal"])},mounted(){this.init()}},l=c,d=(s("34b2"),s("2877")),f=Object(d["a"])(l,n,i,!1,null,null,null),u=f.exports,p=s("a18c"),g=(s("14d9"),{SET_THEME:"setTheme",SET_TAB_NAME:"setTabName",CHANGE_ACTIVE_CHAT:"changeActiveChat",SET_CHAT_LIST:"setChatList",ADD_CHAT_LIST:"addChatList",UPDATE_MSG_LIST:"updateMsgList",CLEAR_MSG_LIST:"clearMsgList",SET_PERSONAL:"setPersonal",CHANGE_USER_INFO:"changeUserInfo",CHANGE_USER_INFO_VISIBLE:"changeUserInfoVisible",CHANGE_FRIEND_REQUEST:"changeFriendRequest",SET_FRIEND_LIST:"setFriendList",SET_MSG_TIPS:"setMsgTips"}),h=s("d800"),m=s("c24f"),b=s("310c"),_=s("5c96"),v=s.n(_),y={options:[{value:"dark",label:"夜晚模式"},{value:"light",label:"白天模式"}],default:"light"};a["default"].use(r["a"]);var w=new r["a"].Store({state:{theme:"",activeTabName:"tab-chat",activeChat:{},chatList:[],msgList:[],personal:{},userInfoVisible:!1,userInfo:{},friendRequest:!1,friendList:[],msgTips:!1},mutations:{[g.SET_THEME](e,t){t=t||y.default;const s=document.getElementsByTagName("body")[0];s.setAttribute("data-theme",t),o["a"].local.set({label:"theme",value:t}),e.theme=y.options.find(e=>e.value===t)},[g.SET_TAB_NAME](e,t){e.activeTabName=t||"tab-chat","tab-chat"===e.activeTabName&&(e.msgTips=!1)},[g.CHANGE_ACTIVE_CHAT](e,t){t.tips=!1,e.activeChat=t},[g.SET_CHAT_LIST](e,t){e.chatList=t,e.activeChat&&(e.activeChat=t.find(t=>t.chatId===e.activeChat.chatId)||{})},[g.ADD_CHAT_LIST](e,t){const s=e.chatList.findIndex(e=>e.chatId===t.chatId);-1!==s&&e.chatList.splice(s,1),e.chatList.unshift(t),e.activeChat=t},[g.UPDATE_MSG_LIST](e,t){if(!t||!t.length)return;t[0].chatId===e.activeChat.chatId&&e.msgList.push(...t);const s=e.chatList.findIndex(e=>e.chatId===t[0].chatId),a=t[t.length-1];a.tips=t[0].chatId!==e.activeChat.chatId,a.editTime=a.createTime,-1!==s?e.chatList.splice(s,1,a):e.chatList.unshift(a),e.chatList.sort((e,t)=>new Date(e.editTime).getTime()<new Date(t.editTime).getTime()?1:-1)},[g.CLEAR_MSG_LIST](e){e.msgList=[]},[g.SET_PERSONAL](e,t){t=t||{},e.personal=t;const{avatar:s,username:a,userId:n}=t;o["a"].local.set({label:"avatar",value:s,type:"user"}),o["a"].local.set({label:"username",value:a,type:"user"}),o["a"].local.set({label:"userId",value:n,type:"user"})},[g.CHANGE_USER_INFO](e,t){e.userInfo=t||{}},[g.CHANGE_USER_INFO_VISIBLE](e,t){t&&(e.userInfo={}),e.userInfoVisible=t},[g.CHANGE_FRIEND_REQUEST](e,t){e.friendRequest=t},[g.SET_FRIEND_LIST](e,t){e.friendList=t||[]},[g.SET_MSG_TIPS](e,t){t&&"tab-chat"===e.activeTabName||(e.msgTips=t)}},actions:{getChatList({commit:e}){h["a"].getChatList().then(t=>{e(g.SET_CHAT_LIST,t.data.list)}).catch(e=>{})},getUserInfo({commit:e},t){e(g.CHANGE_USER_INFO_VISIBLE,!0),m["a"].getInfo(t).then(t=>{t.data.flag?e(g.CHANGE_USER_INFO,t.data.data):_["Message"].auto(t.data)}).catch(e=>{})},getFriendList({commit:e}){b["a"].list().then(t=>{t.data.flag?e(g.SET_FRIEND_LIST,t.data.list):_["Message"].auto(t.data)}).catch(e=>{})}},modules:{}}),j=(s("0fae"),s("5132")),x=s.n(j),k=s("c1df"),C=s.n(k),I={computed:{baseURL(){return"http://65de8585.r5.cpolar.top"},...Object(r["d"])({username:e=>e.personal.username,userId:e=>e.personal.userId,avatar:e=>e.personal.avatar})},filters:{formatDate(e,t="YYYY/MM/DD, HH:mm:ss"){return e=Number(e),C()(Number(e)).format(t)}}};const T={install(e){e.directive("limit",{inserted(e,t){const s=Object.keys(t.modifiers)[0]||"r",a={match:{r:/[0-9.-]/,"+":/[0-9.]/,"n+":/[0-9]/},replace:{r:/[^0-9.-]/g,"+":/[^0-9.]/g,"n+":/[^0-9]/g}};e.onkeypress=e=>{const t=e.charCode;if(0!==t&&!String.fromCharCode(t).match(a.match[s]))return!1},e.addEventListener("textInput",e=>{e.target.value=e.target.value.replace(a.replace[s],"")}),e.onkeyup=e=>{e.target.value=e.target.value.replace(a.replace[s],"")}}}),e.directive("click-outside",{bind(e,t,s){function a(s){if(e.contains(s.target))return!1;t.expression&&t.value(s)}e._vueClickOutside_=a,document.addEventListener("click",a)},unbind(e,t){document.removeEventListener("click",e._vueClickOutside_),delete e._vueClickOutside_}})}};var O=T,S=(s("a27e"),function(){var e=this,t=e._self._c;return t("div",{staticClass:"avatar",style:e.style,on:{click:e.choose}},[t("input",{ref:"file",attrs:{type:"file",hidden:"",accept:e.accept},on:{change:e.uploadFile}})])}),L=[],U=s("365c"),$={name:"avatar",props:{src:{type:String,default:""},size:{type:Number,default:60},shape:{type:String,default:"circle"},upload:{default:!1}},computed:{style(){const e="circle"===this.shape?"100%":"0px",t=this.src?this.baseURL+this.src:s("cf05"),a=[`width:${this.size}px;height:${this.size}px;background-image: url(${t});border-radius:${e}`];return this.upload&&a.push("cursor: pointer"),a.join(";")},limitFileType(){const e=["jpeg","gif","png"];return e.map(e=>"image/"+e)},accept(){return this.limitFileType.join(", ")}},methods:{choose(){this.upload&&this.$refs.file.click()},uploadFile(){const e=this.$refs.file.files[0];if(!e)return;if(!this.limitFileType.includes(e.type))return void this.$message.error("文件格式不支持");const t=new FormData;t.append("avatar",e,e.name);const s=this.$loading({lock:!0,text:"头像上传中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});U["a"].uploadImg(t).then(e=>{s.close(),this.$message.auto(e.data),this.upload&&"function"===typeof this.upload&&this.upload(e.data.url)}).catch(e=>{s.close(),console.log(e)})}}},E=$,R=(s("9c52"),Object(d["a"])(E,S,L,!1,null,"5c4b511d",null)),A=R.exports;a["default"].mixin(I),a["default"].use(O),a["default"].component("avatar",A),_["Message"].auto=e=>{e&&e.message&&_["Message"][e.flag?"success":"error"](e.message)},a["default"].use(v.a),a["default"].use(new x.a({debug:!1,connection:"http://65de8585.r5.cpolar.top"})),a["default"].config.productionTip=!1,new a["default"]({router:p["a"],store:w,render:e=>e(u)}).$mount("#app")},"5b36":function(e,t,s){e.exports=s.p+"img/sleepy-face_1f62a.e4e565b8.png"},"5cc8":function(e,t,s){"use strict";s("127f")},"5d2d":function(e,t,s){"use strict";const a={encrypt(e){return e},decrypt(e){return e}};class n{constructor(e){this.storage=e,this.name="Chat-app-info"}set({label:e,value:t,type:s}){if(!e)return void console.error("label为必填字段");if("data_user"===e)return void console.error("data_user为关键字，请勿用");const n=this.get()||{};try{delete n[e],delete n.data_user[e]}catch(r){}let i={};"user"===s?(n.data_user||(n.data_user={}),i={data:{...n,data_user:{...n.data_user,[e]:t}}}):i={data:{...n,[e]:t}},this.storage.setItem(this.name,a.encrypt(JSON.stringify(i)))}get(e){const t=this.storage.getItem(this.name);if(!t)return null;const s=JSON.parse(a.decrypt(t)).data;return e?s[e]||s.data_user&&s.data_user[e]:s}remove(e,t){if(!e)return;if("data_user"===e&&"sure"!==t)return;const s=this.storage.getItem(this.name);if(!s)return;const n=JSON.parse(a.decrypt(s)).data;delete n[e],n.data_user&&delete n.data_user[e];const i={data:{...n}};this.storage.setItem(this.name,a.encrypt(JSON.stringify(i)))}removeUser(){this.remove("data_user","sure")}clear(){this.storage.remove(this.name)}}const i={local:new n(localStorage),session:new n(sessionStorage)};t["a"]=i},"5e28":function(e,t,s){e.exports=s.p+"img/rolling-on-the-floor-laughing_1f923.2411827c.png"},"5f1d":function(e,t,s){},"5f35":function(e,t,s){"use strict";s("6975")},"63ee":function(e,t,s){e.exports=s.p+"img/face-with-rolling-eyes_1f644.fcccb2e9.png"},6975:function(e,t,s){},"69e2":function(e,t,s){e.exports=s.p+"img/yawning-face_1f971.9d80d92d.png"},"6c3d":function(e,t,s){e.exports=s.p+"img/face-with-hand-over-mouth_1f92d.66eccc9d.png"},"6db9":function(e,t,s){e.exports=s.p+"img/anxious-face-with-sweat_1f630.b8e750b0.png"},"6dbe":function(e,t,s){e.exports=s.p+"img/smiling-face-with-hearts_1f970.7febdee1.png"},7190:function(e,t,s){e.exports=s.p+"img/drooling-face_1f924.d8d33c12.png"},7284:function(e,t,s){e.exports=s.p+"img/money-mouth-face_1f911.8691951c.png"},"746d":function(e,t,s){},7880:function(e,t,s){e.exports=s.p+"img/face-with-tears-of-joy_1f602.8f66bf2e.png"},"7b12":function(e,t,s){"use strict";s("ad0d")},"7b19":function(e,t,s){},"7f8f":function(e,t,s){"use strict";s("cc1c")},"81b6":function(e,t,s){e.exports=s.p+"img/thinking-face_1f914.5e08a60a.png"},8910:function(e,t,s){"use strict";s("483d")},"898e":function(e,t,s){e.exports=s.p+"img/smiling-face_263a-fe0f.2e453c2d.png"},"94d2":function(e,t,s){e.exports=s.p+"img/dizzy-face_1f635.2807e475.png"},"95bf":function(e,t,s){"use strict";s("4ccb")},9815:function(e,t,s){},"99c6":function(e,t,s){},"9c52":function(e,t,s){"use strict";s("3732")},"9d70":function(e,t,s){"use strict";s("d99c")},"9dcc":function(e,t,s){e.exports=s.p+"img/hugging-face_1f917.35de3bfe.png"},"9e08":function(e,t,s){e.exports=s.p+"img/face-vomiting_1f92e.12feadf8.png"},a060:function(e,t,s){e.exports=s.p+"img/grimacing-face_1f62c.b32d052e.png"},a18c:function(e,t,s){"use strict";var a=s("2b0e"),n=s("8c4f"),i=s("5d2d"),r=s("365c");a["default"].use(n["a"]);const o=s("e380"),c=o.keys().map(e=>{const t=e.substring(e.indexOf("/")+1,e.lastIndexOf(".vue"));return console.log("name",t),{path:e.substring(e.indexOf("/"),e.lastIndexOf(".vue")),name:t,component:o(e).default,meta:{title:t}}}),l=new n["a"]({mode:"history",base:"",routes:[{path:"/",component:()=>Promise.resolve().then(s.bind(null,"1e4b"))},...c]}),d=["login"];l.beforeEach((e,t,s)=>{const a=i["a"].local.get("username");a||d.includes(e.name)?s():s({name:"login"})}),l.onReady(e=>{d.includes(e.path)||r["a"].checkOnline().then(()=>{}).catch(()=>{})}),t["a"]=l},a27e:function(e,t,s){"use strict";s("14d9");var a=s("bc3a"),n=s.n(a),i=s("5c96"),r=s("a18c");const o={disabled:!1,sourceArr:[],set(){if(this.disabled)return;const e=n.a.CancelToken,t=e.source();return o.push(t),t.token},push(e){this.disabled||e.token&&this.sourceArr.push(e)},cancel(){this.disabled||(this.sourceArr.forEach(e=>{e.cancel&&e.cancel()}),this.sourceArr=[])},remove(e){if(this.disabled)return;const t=e.config.cancelToken;if(!t)return;const s=this.sourceArr.findIndex(e=>e.token===t);s>=0&&this.sourceArr.splice(s,1)}};var c=o;const l=n.a.create({baseURL:"http://65de8585.r5.cpolar.top",withCredentials:!0,timeout:3e4,headers:{"Cache-Control":"no-cache"}});l.interceptors.request.use(e=>(e.cancelToken=c.set(),e),e=>Promise.reject(e)),l.interceptors.response.use(e=>!1===e.data.flag&&!1===e.data.auth?(c.cancel(),i["Message"].error(e.data.message),r["a"].push("/login"),Promise.reject(e)):(c.remove(e),e),e=>(console.dir(e),e.message&&i["Message"].error(e.message),Promise.reject(e))),window.axios=l;t["a"]=l},a2e8:function(e,t,s){e.exports=s.p+"img/face-screaming-in-fear_1f631.2b5e893a.png"},a454:function(e,t,s){e.exports=s.p+"img/flushed-face_1f633.73903dd3.png"},a62e:function(e,t,s){"use strict";s("5f1d")},abea:function(e,t,s){},ad0d:function(e,t,s){},b0cd:function(e,t,s){},b236:function(e,t,s){e.exports=s.p+"img/disguised-face_1f978.b16a8bd3.png"},b31a:function(e,t,s){e.exports=s.p+"img/fearful-face_1f628.59fab155.png"},b6ba:function(e,t,s){"use strict";s("4d48")},b8e1:function(e,t,s){e.exports=s.p+"img/smiling-face-with-sunglasses_1f60e.ec97e8af.png"},bafb:function(e,t,s){e.exports=s.p+"img/face-with-monocle_1f9d0.7a3371ba.png"},bec4:function(e,t,s){e.exports=s.p+"img/partying-face_1f973.6b2188e5.png"},c24f:function(e,t,s){"use strict";var a=s("a27e");t["a"]={signIn(e){return a["a"].post("/user/signIn",e)},signUp(e){return a["a"].post("/user/signUp",e)},signOut(){return a["a"].get("/user/signOut")},getInfo(e){return a["a"].get("/user/info/"+e)},search(e){return a["a"].get("/user/search",{params:e})},update(e){return a["a"].post("/user/update",e)}}},c6a6:function(e,t,s){},c6b7:function(e,t,s){"use strict";s("de7d")},c77b:function(e,t,s){e.exports=s.p+"img/beaming-face-with-smiling-eyes_1f601.c502df39.png"},cc1c:function(e,t,s){},cd30:function(e,t,s){"use strict";s("2f17")},cf05:function(e,t,s){e.exports=s.p+"img/logo.7da0cf21.png"},d0c2:function(e,t,s){"use strict";s("fb15")},d2e8:function(e,t,s){e.exports=s.p+"img/face-with-thermometer_1f912.0a1ed714.png"},d46d:function(e,t,s){e.exports=s.p+"img/exploding-head_1f92f.b6e43039.png"},d634:function(e,t,s){"use strict";s("c6a6")},d7df:function(e,t,s){"use strict";s("ee42")},d800:function(e,t,s){"use strict";var a=s("a27e");t["a"]={getChatList(){return a["a"].get("/chat/list")},chatRemove(e){return a["a"].delete("/chat/remove/"+e)},send(e){return a["a"].get("/single/send",{params:e})},getSingleRecord(e){return a["a"].get("/single/record/"+e)},getGroupRecord(e){return a["a"].get("/group/record/"+e)},createGroup(e){return a["a"].post("/group/create",e)},groupInfo(e){return a["a"].get("/group/info/"+e)},groupUpdate(e){return a["a"].patch("/group/update",e)},groupRemove(e){return a["a"].patch("/group/remove",e)},groupAppend(e){return a["a"].patch("/group/append",e)},groupQuit(e){return a["a"].patch("/group/quit",e)},groupDisband(e){return a["a"].delete("/group/disband/"+e)}}},d99c:function(e,t,s){},daa5:function(e,t,s){e.exports=s.p+"img/upside-down-face_1f643.0e7d9508.png"},dd7b:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"login-con",attrs:{tabindex:"1"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.enter.apply(null,arguments)}}},[t("div",{staticClass:"form-con"},["signIn"===e.type?[t("p",{staticClass:"title"},[e._v("sign in")]),t("i",{staticClass:"iconfont icon-signup",on:{click:function(t){e.type="signUp"}}}),t("el-form",{ref:"signIn",attrs:{model:e.signIn}},[t("el-form-item",[t("el-input",{attrs:{placeholder:"username",clearable:"",maxLength:"16"},model:{value:e.signIn.username,callback:function(t){e.$set(e.signIn,"username",t)},expression:"signIn.username"}})],1),t("el-form-item",[t("el-input",{attrs:{placeholder:"password",clearable:"",maxLength:"16",type:"password","show-password":""},model:{value:e.signIn.password,callback:function(t){e.$set(e.signIn,"password",t)},expression:"signIn.password"}}),t("div",{staticClass:"tips"},[t("a",[e._v("forget?")])])],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.signInAction}},[e._v("Next")])],1)],1)]:[t("p",{staticClass:"title"},[e._v("sign up")]),t("i",{staticClass:"iconfont icon-signin",on:{click:function(t){e.type="signIn"}}}),t("el-form",{ref:"signUp",attrs:{model:e.signUp}},[t("el-form-item",[t("el-input",{attrs:{placeholder:"username",clearable:"",maxLength:"16",title:"username"},model:{value:e.signUp.username,callback:function(t){e.$set(e.signUp,"username",t)},expression:"signUp.username"}})],1),t("el-form-item",[t("el-input",{attrs:{placeholder:"password",clearable:"",maxLength:"16",title:"password",type:"password","show-password":""},model:{value:e.signUp.password,callback:function(t){e.$set(e.signUp,"password",t)},expression:"signUp.password"}})],1),t("el-form-item",[t("el-input",{attrs:{placeholder:"password",clearable:"",maxLength:"16",title:"confirm password",type:"password","show-password":""},model:{value:e.signUp.cfPassword,callback:function(t){e.$set(e.signUp,"cfPassword",t)},expression:"signUp.cfPassword"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.signUpAction}},[e._v("Next")])],1)],1)]],2)])},n=[],i=(s("14d9"),s("4328")),r=s.n(i),o=s("c24f"),c=s("5d2d"),l=s("2f62"),d={name:"login",data(){return{type:"signIn",signIn:{username:"",password:""},signUp:{username:"",password:"",cfPassword:""}}},methods:{init(){this.$socket.disconnect(),c["a"].local.removeUser(),this.changeUserInfoVisible(!1)},signInAction(){this.signIn.username&&o["a"].signIn(r.a.stringify(this.signIn)).then(e=>{this.$message.auto(e.data),e.data.flag&&(this.connectSocket(),this.setPersonal(e.data.user),Object.assign(this.$data.signIn,this.$options.data().signIn),this.$router.push("/"))}).catch(e=>{})},signUpAction(){this.signUp.username&&o["a"].signUp(r.a.stringify(this.signUp)).then(e=>{this.$message.auto(e.data),e.data.flag&&(this.type="signIn")}).catch(e=>{})},enter(){this[this.type+"Action"]()},connectSocket(){this.$socket.disconnect(),this.$socket.connect()},...Object(l["c"])(["setPersonal","changeUserInfoVisible"])},created(){},mounted(){this.init()},watch:{type(){Object.assign(this.$data.signIn,this.$options.data().signIn),Object.assign(this.$data.signUp,this.$options.data().signUp)}}},f=d,u=(s("a62e"),s("2877")),p=Object(u["a"])(f,a,n,!1,null,"43959bd6",null);t["default"]=p.exports},dde3:function(e,t,s){"use strict";s("b0cd")},de7d:function(e,t,s){},e15c:function(e,t,s){"use strict";s("99c6")},e380:function(e,t,s){var a={"./index.vue":"1e4b","./login.vue":"dd7b"};function n(e){var t=i(e);return s(t)}function i(e){if(!s.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}n.keys=function(){return Object.keys(a)},n.resolve=i,e.exports=n,n.id="e380"},e6f2:function(e,t,s){e.exports=s.p+"img/hot-face_1f975.10fe6fb4.png"},eab6:function(e,t,s){e.exports=s.p+"img/sleeping-face_1f634.07cbeb7d.png"},ebd3:function(e,t,s){e.exports=s.p+"img/pleading-face_1f97a.01216770.png"},ee42:function(e,t,s){},ef5e:function(e,t,s){e.exports=s.p+"img/persevering-face_1f623.5cc1503c.png"},efea:function(e,t,s){e.exports=s.p+"img/smiling-face-with-smiling-eyes_1f60a.90337b35.png"},f828:function(e,t,s){e.exports=s.p+"img/zany-face_1f92a.fb3b5765.png"},f8cb:function(e,t,s){"use strict";s("5441")},fa70:function(e,t,s){e.exports=s.p+"img/grinning-squinting-face_1f606.2145c32e.png"},fb15:function(e,t,s){},fc6c:function(e,t,s){e.exports=s.p+"img/smiling-face-with-heart-eyes_1f60d.a7f6e428.png"}});